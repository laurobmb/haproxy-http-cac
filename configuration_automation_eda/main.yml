---
- name: Add credential to EDA Controller
  hosts: localhost
  connection: local
  gather_facts: false

  vars_files:
    - vars/main.yml
    - platform_configs/eda_auth.yml

  vars:
    project_description: Automacao CAC para projeto HAPROXY
    project_state: present
    project_organization: devops
    eda_configuration_credentials_secure_logging: false

  pre_tasks:
    - name: Include vars from eda_configs directory
      ansible.builtin.include_vars:
        dir: playbooks/
        extensions: ["yml"]
      tags:
        - always

  roles:
    - {role: infra.aap_configuration.eda_credentials, when: eda_credentials is defined}
    - {role: infra.aap_configuration.eda_projects, when: eda_projects is defined}
    - {role: infra.aap_configuration.eda_decision_environments, when: eda_decision_environments is defined}

    - {role: infra.aap_configuration.eda_rulebook_activations, when: eda_rulebook_activations is defined}
